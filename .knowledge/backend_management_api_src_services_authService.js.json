{"is_source_file": true, "format": "JavaScript", "description": "This file defines an AuthService class responsible for handling user authentication logic, including password hashing, token generation, user registration, login, and token verification within a Node.js backend project.", "external_files": ["../config/auth", "../repositories/userRepository"], "external_methods": ["bcrypt.hash", "bcrypt.compare", "jwt.sign", "jwt.verify", "userRepository.emailExists", "userRepository.usernameExists", "userRepository.create", "userRepository.findById", "userRepository.findByEmail", "userRepository.findByUsername", "userRepository.updateLastLogin"], "published": [], "classes": [{"name": "AuthService", "description": "A service class providing authentication-related functionalities such as password hashing, token management, user registration, and login."}], "methods": [{"name": "hashPassword(password)", "description": "Hashes a plaintext password using bcrypt.", "scope": "AuthService", "scopeKind": "class"}, {"name": "comparePassword(password, hash)", "description": "Compares a plaintext password with a hashed password.", "scope": "AuthService", "scopeKind": "class"}, {"name": "generateAccessToken(user)", "description": "Generates a JWT access token with user payload.", "scope": "AuthService", "scopeKind": "class"}, {"name": "generateRefreshToken(user)", "description": "Generates a JWT refresh token for user sessions.", "scope": "AuthService", "scopeKind": "class"}, {"name": "verifyAccessToken(token)", "description": "Verifies and decodes a JWT access token.", "scope": "AuthService", "scopeKind": "class"}, {"name": "verifyRefreshToken(token)", "description": "Verifies and decodes a JWT refresh token.", "scope": "AuthService", "scopeKind": "class"}, {"name": "register(userData)", "description": "Registers a new user, hashes their password, creates user record, and returns user info with tokens.", "scope": "AuthService", "scopeKind": "class"}, {"name": "login(login, password)", "description": "Authenticates user credentials, updates login timestamp, and issues tokens.", "scope": "AuthService", "scopeKind": "class"}, {"name": "refreshToken(refreshToken)", "description": "Generates a new access token using a valid refresh token.", "scope": "AuthService", "scopeKind": "class"}, {"name": "sanitizeUser(user)", "description": "Removes sensitive fields from user object before returning.", "scope": "AuthService", "scopeKind": "class"}], "calls": ["bcrypt.hash", "bcrypt.compare", "jwt.sign", "jwt.verify", "userRepository.emailExists", "userRepository.usernameExists", "userRepository.create", "userRepository.findById", "userRepository.findByEmail", "userRepository.findByUsername", "userRepository.updateLastLogin"], "search-terms": ["AuthService", "JWT token generation", "password hashing", "user registration", "login authentication", "refresh token"], "state": 2, "file_id": 17, "knowledge_revision": 43, "git_revision": "b80dcfb3561de1fc03f5c316b50eb11e51e9d786", "ctags": [{"_type": "tag", "name": "AuthService", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^class AuthService {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "authConfig", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^const authConfig = require('..\\/config\\/auth');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "bcrypt", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^const bcrypt = require('bcrypt');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "comparePassword", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^  async comparePassword(password, hash) {$/", "language": "JavaScript", "kind": "method", "signature": "(password, hash)", "scope": "AuthService", "scopeKind": "class"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^      email: user.email,$/", "language": "JavaScript", "kind": "property", "scope": "AuthService.generateAccessToken.payload", "scopeKind": "class"}, {"_type": "tag", "name": "exports", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^module.exports = new AuthService();$/", "language": "JavaScript", "kind": "variable", "scope": "module", "scopeKind": "class"}, {"_type": "tag", "name": "generateAccessToken", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^  generateAccessToken(user) {$/", "language": "JavaScript", "kind": "method", "signature": "(user)", "scope": "AuthService", "scopeKind": "class"}, {"_type": "tag", "name": "generateRefreshToken", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^  generateRefreshToken(user) {$/", "language": "JavaScript", "kind": "method", "signature": "(user)", "scope": "AuthService", "scopeKind": "class"}, {"_type": "tag", "name": "hashPassword", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^  async hashPassword(password) {$/", "language": "JavaScript", "kind": "method", "signature": "(password)", "scope": "AuthService", "scopeKind": "class"}, {"_type": "tag", "name": "jwt", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^const jwt = require('jsonwebtoken');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "login", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^  async login(login, password) {$/", "language": "JavaScript", "kind": "method", "signature": "(login, password)", "scope": "AuthService", "scopeKind": "class"}, {"_type": "tag", "name": "municipalityId", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^      municipalityId: user.municipality_id,$/", "language": "JavaScript", "kind": "property", "scope": "AuthService.generateAccessToken.payload", "scopeKind": "class"}, {"_type": "tag", "name": "payload", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^    const payload = {$/", "language": "JavaScript", "kind": "class", "scope": "AuthService.generateAccessToken", "scopeKind": "class"}, {"_type": "tag", "name": "payload", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^    const payload = {$/", "language": "JavaScript", "kind": "class", "scope": "AuthService.generateRefreshToken", "scopeKind": "class"}, {"_type": "tag", "name": "refreshToken", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^  async refreshToken(refreshToken) {$/", "language": "JavaScript", "kind": "method", "signature": "(refreshToken)", "scope": "AuthService", "scopeKind": "class"}, {"_type": "tag", "name": "register", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^  async register(userData) {$/", "language": "JavaScript", "kind": "method", "signature": "(userData)", "scope": "AuthService", "scopeKind": "class"}, {"_type": "tag", "name": "roleId", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^      roleId: user.role_id,$/", "language": "JavaScript", "kind": "property", "scope": "AuthService.generateAccessToken.payload", "scopeKind": "class"}, {"_type": "tag", "name": "roleName", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^      roleName: user.role_name,$/", "language": "JavaScript", "kind": "property", "scope": "AuthService.generateAccessToken.payload", "scopeKind": "class"}, {"_type": "tag", "name": "sanitizeUser", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^  sanitizeUser(user) {$/", "language": "JavaScript", "kind": "method", "signature": "(user)", "scope": "AuthService", "scopeKind": "class"}, {"_type": "tag", "name": "type", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^      type: 'access',$/", "language": "JavaScript", "kind": "property", "scope": "AuthService.generateAccessToken.payload", "scopeKind": "class"}, {"_type": "tag", "name": "type", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^      type: 'refresh',$/", "language": "JavaScript", "kind": "property", "scope": "AuthService.generateRefreshToken.payload", "scopeKind": "class"}, {"_type": "tag", "name": "userId", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^      userId: user.id,$/", "language": "JavaScript", "kind": "property", "scope": "AuthService.generateAccessToken.payload", "scopeKind": "class"}, {"_type": "tag", "name": "userId", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^      userId: user.id,$/", "language": "JavaScript", "kind": "property", "scope": "AuthService.generateRefreshToken.payload", "scopeKind": "class"}, {"_type": "tag", "name": "userRepository", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^const userRepository = require('..\\/repositories\\/userRepository');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "username", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^      username: user.username,$/", "language": "JavaScript", "kind": "property", "scope": "AuthService.generateAccessToken.payload", "scopeKind": "class"}, {"_type": "tag", "name": "verifyAccessToken", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^  verifyAccessToken(token) {$/", "language": "JavaScript", "kind": "method", "signature": "(token)", "scope": "AuthService", "scopeKind": "class"}, {"_type": "tag", "name": "verifyRefreshToken", "path": "/home/kavia/workspace/code-generation/secure-community-management-system-299076-299085/backend_management_api/src/services/authService.js", "pattern": "/^  verifyRefreshToken(token) {$/", "language": "JavaScript", "kind": "method", "signature": "(token)", "scope": "AuthService", "scopeKind": "class"}], "hash": "8ff2cb1b3e7e19bbdc99d3793d398859", "format-version": 4, "code-base-name": "backend_management_api", "filename": "backend_management_api/src/services/authService.js", "fields": [{"name": "email: user.email,", "scope": "AuthService.generateAccessToken.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "module.exports = new AuthService();", "scope": "module", "scopeKind": "class", "description": "unavailable"}, {"name": "municipalityId: user.municipality_id,", "scope": "AuthService.generateAccessToken.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "roleId: user.role_id,", "scope": "AuthService.generateAccessToken.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "roleName: user.role_name,", "scope": "AuthService.generateAccessToken.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "type: 'access',", "scope": "AuthService.generateAccessToken.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "type: 'refresh',", "scope": "AuthService.generateRefreshToken.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "userId: user.id,", "scope": "AuthService.generateAccessToken.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "username: user.username,", "scope": "AuthService.generateAccessToken.payload", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"43": "b80dcfb3561de1fc03f5c316b50eb11e51e9d786"}]}